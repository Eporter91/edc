/*!CK:679242747!*//*1434939287,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["v3+43"]); }

__d("ActivityLogStory",["ge","DOM","Event","Toggler","Run"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={removeStory:function(m,n){var o=g(m);o&&h.setContent(o,n);},registerPopover:function(m){var n=i.listen(window,'scroll',function(o){j.hide(m);});k.onLeave(n.remove.bind(n));}};e.exports=l;},null);
__d("AllActivityContentLoader",["Arbiter","CSS","DOM","DOMScroll","OnVisible","Parent","MorePagerFetchOnScroll","TimelineComponentKeys","TimelineConstants","TimelineController","TimelineLegacySections","TimelineSmartInsert","UIPagelet","Vector","$","clickRefAction","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();var x=false,y=0,z=null,aa={},ba=[],ca={},da=[],ea=null;function fa(ja,ka,la,ma,na){this.node=ja;this._canScrollLoad=true;this.scrubberKey=ka;this._pageletLoadData=la;this.loaded=ma;this.sortKey=na;this.contentNode=i.scry(ja,"div._z6j")[0];}function ga(){if(x)return;p.register(n.CONTENT,ia);v('scrubber').set_namespace('allactivity');x=true;}function ha(ja){var ka=q.get(ja);ka&&ka._canScrollLoad&&ka.load();}Object.assign(fa.prototype,{load:function(){if(this.loaded)return;this.loaded=true;this.contentNode&&h.hide(this.contentNode);h.show(l.byClass(this.node,'fbTimelineSection'));var ja=this.node;function ka(ma){r.run(ja,ma);}var la=i.find(this.node,'div.fbTimelineLogStream');da.push(s.loadFromEndpoint('TimelineEntStoryActivityLogPagelet',la.id,this._pageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:ka,append:true}));},contentAdded:function(ja){if(!this.hasContent){h.removeClass(l.byClass(this.node,'stat_elem'),'async_saving');if(this.contentNode){ja&&i.prependContent(this.contentNode,ja);h.show(this.contentNode);}this.hasContent=true;}},fullyLoaded:function(){if(!this.hasContent){h.removeClass(l.byClass(this.node,'stat_elem'),'async_saving');h.show(i.find(this.node,"div._40pu"));this.contentNode&&h.hide(this.contentNode);}},activateScrollLoad:function(){this._canScrollLoad=true;ca[this.scrubberKey]&&ca[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this._canScrollLoad=false;}else{var ja=i.scry(this.node,'.uiMorePager');if(ja)ja.map(function(ka){var la=m.getInstance(ka.id);la&&la.removeEventListeners();});}ca[this.scrubberKey]&&ca[this.scrubberKey].remove();},getParent:function(){if(this.parentKey)return q.get(this.parentKey);return null;}});var ia={SCROLL_TO_OFFSET:115,HEADER_SCROLL_CUTOFF:30,CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(ja,ka,la,ma,na,oa){ga();var pa=new fa(ja,ka,la,ma,oa);if(!na){ba.push(ka);aa[ka]=true;}else{pa.parentKey=na;q.get(na).subSections=q.get(na).subSections||[];q.get(na).subSections.push(pa);q.get(na).subSections.sort(function(qa,ra){return ra.sortKey-qa.sortKey;});}q.set(ka,pa);ia.checkCurrentSectionChange();g.inform(o.SECTION_REGISTERED,{scrubberKey:ka},g.BEHAVIOR_PERSISTENT);},reset:function(){ia.stopLoadingContent();x=false;q.removeAll();y=0;z=null;aa={};ba=[];ca={};da=[];ea=null;},stopLoadingContent:function(){for(var ja in ca)ca[ja]&&ca[ja].remove();for(var ka=0;ka<da.length;ka++)da[ka].cancel();},setContentHeader:function(ja){ea=ja;},checkCurrentSectionChange:function(){var ja=ia.getCurrentSection(),ka=z&&z.scrubberKey;if(ja&&ja.scrubberKey!==ka){z=ja;var la=ja.scrubberKey,ma=ja.parentKey;if(!ma){ma=la;la=null;}p.sectionHasChanged(ma,la);}},getCurrentSection:function(){var ja={},ka=q.getAll();for(var la in ka){var ma=ka[la];if(!ma.loaded)continue;var na=t.getElementPosition(ma.node,'viewport').y;if(na<ia.CURRENT_SECTION_OFFSET)ja[na]=ma;}var oa=Math.max.apply(this,Object.keys(ja)),pa=oa==-Infinity;if(!pa){return ja[oa];}else return null;},enableScrollLoad:function(ja,ka,la){ja=u(ja);var ma=ia.getNextSectionKey(ka);if(ma)ca[ma]=new k(ja,ha.bind(null,ma),false,la||1000);},getNextSectionKey:function(ja){var ka=q.get(ja),la=ka.getParent(),ma=null,na=null;if(la)for(var oa=0;oa<la.subSections.length-1;oa++)if(la.subSections[oa].scrubberKey==ja)ma=la.subSections[oa+1].scrubberKey;if(!ma)for(var pa=0;pa<ba.length-pa;pa++)if(ba[pa]==la.scrubberKey){na=q.get(ba[pa+1]).subSections[0];if(na)ma=na.scrubberKey;}return ma;},navigateToSection:function(ja,ka,la){ka=!!ka;var ma=q.get(ja);if(!ma)return;if(!ma.getParent()){ja=ma.subSections[0].scrubberKey;ma=q.get(ja);}for(var na=0;na<ba.length;na++){var oa=q.get(ba[na]);for(var pa=0;pa<oa.subSections.length;pa++){if(oa.subSections[pa].scrubberKey==ja)break;oa.subSections[pa].deactivateScrollLoad();}if(oa.scrubberKey==ma.getParent().scrubberKey)break;}ma.activateScrollLoad();ma.load();ia.adjustContentPadding();var qa=t.getScrollPosition().x,ra=t.getElementPosition(ma.node).y;if(!ka){var sa=ia.SCROLL_TO_OFFSET;j.scrollTo(new t(qa,ra-sa,'document'));}},adjustContentPadding:function(){u('fbTimelineLogBody').style.paddingBottom=t.getViewportDimensions().y-ia.CURRENT_SECTION_OFFSET-ia.HEADER_SCROLL_CUTOFF+'px';},sectionHasContent:function(ja){var ka=q.get(ja);ka&&ka.contentAdded(ea);ea=null;},sectionFullyLoaded:function(ja){var ka=q.get(ja);ka&&ka.fullyLoaded();}};e.exports=ia;},null);
__d("ActivityLogSearch",["Event","CSS","DOM","Input","Run"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();function l(m,n,o){var p=i.find(o,'.inputtext'),q=g.listen(n,'click',function(){h.hide(m);h.show(o);p.focus();});k.onLeave(q.remove.bind(q));var r=g.listen(p,'blur',function(){if(!j.getValue(p)){h.hide(o);h.show(m);}});k.onLeave(r.remove.bind(r));}e.exports=l;},null);
__d("PopoverMenuDynamicTooltip",["DOMQuery","Tooltip","csx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this._popoverMenu=k;this._setMenuSubscription=null;this._changeSubscription=null;}j.prototype.enable=function(){"use strict";this._setMenuSubscription=this._popoverMenu.subscribe('setMenu',this._onSetMenu.bind(this));};j.prototype.disable=function(){"use strict";this._popoverMenu.unsubscribe(this._setMenuSubscription);this._setMenuSubscription=null;this._removeChangeSubscription();};j.prototype._onSetMenu=function(){"use strict";this._removeChangeSubscription();this._menu=this._popoverMenu.getMenu();this._changeSubscription=this._menu.subscribe('change',function(k,l){var m=l.item;if(l[0])m=l[0].item;if(!m)return;var n=m.getLabel();n=n?n.toString():null;if(!n)return;var o=this._popoverMenu.getTriggerElem(),p=g.scry(o,"span._55pe")[0];if(p&&p.nodeName){var q=p.parentNode;if(q)h.set(q,n);}}.bind(this));};j.prototype._removeChangeSubscription=function(){"use strict";if(this._changeSubscription){this._menu.unsubscribe(this._changeSubscription);this._changeSubscription=null;}};e.exports=j;},null);
__d("ScrollHighlight",["DOMScroll","highlight"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={actOn:function(j,k,l){g.scrollTo(j,true,false,false,l);h(j,null,k);}};e.exports=i;},null);
__d("ProfileApprovalController",["AsyncRequest","DOM","Event","HTML","$","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(n){"use strict";this.queueType=n;var o=l('profileApprovalSeeMoreLink');if(o)i.listen(o,'click',this.clickedSeeMore.bind(this));}m.prototype.getNewStories=function(){"use strict";var n=this.getStoryData(),o={filter:this.FILTER_NEWER,filter_timestamp:n.newest_time,filter_fbid:n.newest_fbid};new g().setURI('/ajax/profile/approval/get_more.php').setData(o).setHandler(this.handleContent).send();};m.prototype.clickedSeeMore=function(){"use strict";var n=this.getStoryData(),o={queue_type:this.queueType,filter:this.FILTER_OLDER,filter_timestamp:n.oldest_time,filter_fbid:n.oldest_fbid};new g().setURI('/ajax/profile/approval/get_more.php').setData(o).setHandler(this.handleContent).send();};m.prototype.handleContent=function(n){"use strict";var o=n.payload;if(o.pager_error){h.replace(k('profileApprovalSeeMoreContainer'),j(o.pager_markup));return;}if(o.hide_more_pager)h.remove(k('profileApprovalSeeMoreContainer'));if(!o.items_markup)return;if(o.insert_before)h.prependContent(h.find(k('profileApprovalContentContainer'),'.profileApprovalList'),j(o.items_markup));if(o.insert_after)h.appendContent(h.find(k('profileApprovalContentContainer'),'.profileApprovalList'),j(o.items_markup));};m.prototype.getStoryData=function(){"use strict";var n=h.scry(k('profileApprovalContentContainer'),'.profileApprovalStoryContainer');if(!n)return;var o=n[0],p=n[n.length-1];return {newest_time:o.getAttribute('data-timestamp'),newest_fbid:o.getAttribute('data-fbid'),oldest_time:p.getAttribute('data-timestamp'),oldest_fbid:p.getAttribute('data-fbid')};};m.NO_MORE_CONTENT='no_more_content';Object.assign(m.prototype,{FILTER_NONE:0,FILTER_OLDER:1,FILTER_NEWER:2});e.exports=m;},null);
__d("legacy:profile-approval-controller",["ProfileApprovalController"],function(a,b,c,d){b.__markCompiled&&b.__markCompiled();a.ProfileApprovalController=b('ProfileApprovalController');},3);
__d("TimelineAllActivitySideNav",["CSS","DOM","DOMDimensions","DOMQuery","FutureSideNav","PageTransitions","Scroll","Style","UIPagelet","$","copyProperties","csx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();function t(v){var w=v==='review'||v==='tagreview',x=s('rightColContent'),y=x&&j.scry(x,".fbTimelineLogScrubber")[0];y&&g.conditionShow(y,!w);}var u={init:function(v,w,x,y,z){var aa=j.find(p('contentArea'),"._6-0"),ba=h.getID(aa);n.set(aa,'minHeight',i.getViewportDimensions().height+'px');g.addClass(v,'fixed_elem');t(z||'all');l.registerHandler(function(ca){if(w===ca.getPath()&&ca.getQueryData().sk==x){var da=q({profile_id:y,renderContentsOnly:1,uripath:ca.toString()},ca.getQueryData()),ea=k.getInstance(),fa=ea&&ea._getItemForKey(da.log_filter||'all');fa&&ea.setLoading(fa);o.loadFromEndpoint('TimelineAllActivityColumn',ba,da,{jsNonblock:true,constHeight:true,displayCallback:function(ga){ga();fa&&ea.setSelected(fa);m.setTop(document.body,0);t(da.log_filter||'all');l.transitionComplete(true);}});return true;}return false;});}};e.exports=u;},null);
__d("ApprovalQueueCountUpdater",["ge","Arbiter","DOM"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={updateCounts:function(k,l){var m=k.friends+k.others,n=g('tag_count_friends'),o=g('tag_count_other');h.inform('NavigationMessage/navigationCount',{key:'review',count:m,hide:true});i.setContent(n,k.friends<=l?k.friends:l+"+");i.setContent(o,k.others<=l?k.others:l+"+");}};e.exports=j;},null);